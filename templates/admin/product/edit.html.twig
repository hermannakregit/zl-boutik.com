{% extends 'admin/base.html.twig' %}

{% block title %}Produits{% endblock %}


{% block pageTitle %}Produits{% endblock pageTitle %}

{% block pageBody %}

    <div class="row">
        <div class="col-md-8 col-xl-8">
            <div class="card">
                {{ form_start(product_form) }}
                <div class="card-header">
                    <h5 class="card-title">Modifier le produit</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Nom</label>
                        {% if form_errors(product_form.name) %}
                            {{ form_widget(product_form.name, {'attr': {'class': 'form-control is-invalid'}}) }}
                            <span class="invalid-feedback">{{ form_errors(product_form.name) }}</span>
                        {% else %}
                            {{ form_widget(product_form.name, {'attr': {'class': 'form-control'}}) }}
                        {% endif %}
                        
                    </div>
                    <div class="row mb-3">
                        <label class="form-label">Prix</label>
                        <div class="col-lg-6">
                            <div class="input-group input-group-flat">
                                {% if form_errors(product_form.priceXof) %}
                                    <span class="input-group-text border border-danger"> XOF </span>
                                    {{ form_widget(product_form.priceXof, {'attr': {'class': 'form-control ps-1 is-invalid'}}) }}
                                    <span class="invalid-feedback">{{ form_errors(product_form.priceXof) }}</span>
                                {% else %}
                                    <span class="input-group-text"> XOF </span>
                                    {{ form_widget(product_form.priceXof, {'attr': {'class': 'form-control ps-1'}}) }}
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="input-group input-group-flat">
                                {% if form_errors(product_form.priceEur) %}
                                    <span class="input-group-text border border-danger"> EUR </span>
                                    {{ form_widget(product_form.priceEur, {'attr': {'class': 'form-control ps-1 is-invalid'}}) }}
                                    <span class="invalid-feedback">{{ form_errors(product_form.priceEur) }}</span>
                                {% else %}
                                    <span class="input-group-text"> EUR </span>
                                    {{ form_widget(product_form.priceEur, {'attr': {'class': 'form-control ps-1'}}) }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Réduction</label>
                        <div class="input-group input-group-flat">
                            {% if form_errors(product_form.reduction) %}
                                <span class="input-group-text border border-danger"> % </span>
                                {{ form_widget(product_form.reduction, {'attr': {'class': 'form-control ps-1 is-invalid'}}) }}
                                <span class="invalid-feedback">{{ form_errors(product_form.reduction) }}</span>
                            {% else %}
                                <span class="input-group-text"> % </span>
                                {{ form_widget(product_form.reduction, {'attr': {'class': 'form-control ps-1'}}) }}
                            {% endif %}
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image Principale</label>
                        {% if form_errors(product_form.imageFile) %}
                            <div class="text-center">
                                {{ form_widget(product_form.imageFile, {'attr': {'class': 'form-control mb-3 is-invalid'}}) }}
                            </div>
                            
                        {% else %}
                            <div class="text-center">
                                {{ form_widget(product_form.imageFile, {'attr': {'class': 'form-control mb-3'}}) }}
                            </div>
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image Principale</label>
                        {% if form_errors(product_form.images) %}
                            {{ form_widget(product_form.images, {'attr': {'class': 'form-control is-invalid'}}) }}
                            <span class="invalid-feedback">{{ form_errors(product_form.images) }}</span>
                        {% else %}
                            {{ form_widget(product_form.images, {'attr': {'class': 'form-control'}}) }}
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Slug</label>
                        {% if form_errors(product_form.slug) %}
                            {{ form_widget(product_form.slug, {'attr': {'class': 'form-control is-invalid'}}) }}
                            <span class="invalid-feedback">{{ form_errors(product_form.slug) }}</span>
                        {% else %}
                            {{ form_widget(product_form.slug, {'attr': {'class': 'form-control'}}) }}
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Catégorie</label>
                        {% if form_errors(product_form.category) %}
                            {{ form_widget(product_form.category, {'attr': {'class': 'form-control form-select is-invalid'}}) }}
                            <span class="invalid-feedback">{{ form_errors(product_form.category) }}</span>
                        {% else %}
                            {{ form_widget(product_form.category, {'attr': {'class': 'form-control form-select'}}) }}
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        {% if form_errors(product_form.description) %}
                            {{ form_widget(product_form.description, {'attr': {'class': 'form-control is-invalid', 'id': 'tinymce-product-textarea'}}) }}
                            <span class="invalid-feedback">{{ form_errors(product_form.description) }}</span>
                        {% else %}
                            {{ form_widget(product_form.description, {'attr': {'class': 'form-control', 'id': 'tinymce-product-textarea'}}) }}
                        {% endif %}
                    </div>
                    <div class="mb-3">
                        <div class="form-label">Rendre le produit disponible</div>
                        <label class="form-check form-switch">
                            {{ form_widget(product_form.active, {'attr': {'class': 'form-check-input', 'checked': 'true'}}) }}
                            <span class="form-check-label">Active</span>
                        </label>
                    </div>
                    <div class="card-footer">
                        <button type="submit" formnovalidate class="btn btn-primary ms-auto float-end mb-3">
                            <!-- Download SVG icon from http://tabler-icons.io/i/plus -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>
                            Modifier le produit
                        </button>
                    </div>
                </div>
            {{ form_end(product_form) }}
            </div>
        </div>
        <div class="col-md-4 col-xl-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Images associées</h5>
                </div>
                <div class="card-body">
                    {% for image in product.images %}
                        <div class="card my-1">
                            <div class="card-body text-center">
                                <img src="{{ asset('/uploads/products/' ~ image.name) }}" alt="{{ image.name }}" width="250rem" height="250rem" style="object-fit: cover;">
                                <div class="card-footer">
                                    <a href="#" class="btn btn-icon" aria-label=action" data-bs-toggle="modal" data-bs-target="#modal-danger-{{ image.id }}">
                                        <!-- Download SVG icon from http://tabler-icons.io/i/brand-facebook -->
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash text-danger" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                          <line x1="4" y1="7" x2="20" y2="7"></line>
                                          <line x1="10" y1="11" x2="10" y2="17"></line>
                                          <line x1="14" y1="11" x2="14" y2="17"></line>
                                          <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path>
                                          <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>
                                       </svg>
                                    </a>    
                                </div>
                                <div class="modal modal-blur fade" id="modal-danger-{{ image.id }}" tabindex="-1" role="dialog" aria-hidden="true">
                                    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                                      <div class="modal-content">
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        <div class="modal-status bg-danger"></div>
                                        <div class="modal-body text-center py-4">
                                          <!-- Download SVG icon from http://tabler-icons.io/i/alert-triangle -->
                                          <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v2m0 4v.01" /><path d="M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75" /></svg>
                                          <h3>Êtes-vous sûr?</h3>
                                          <div class="text-muted">Vous allez suprimer cette image, l'action est irreversible !</div>
                                        </div>
                                        <div class="modal-footer">
                                          <div class="w-100">
                                            <div class="row">
                                              <div class="col"><a href="#" class="btn w-100" data-bs-dismiss="modal">
                                                  Annuler
                                                </a>
                                              </div>
                                              <div class="col">
                                                <form action="{{ path('app_admin_product_image_delete', {id: image.id}) }}" method="post">
                                                  <input type="hidden" name="csrf_token" value="{{ csrf_token('product_image_deletion_' ~ image.id) }}">
                                                  <button type="submit" class="btn btn-danger w-100">
                                                    Suprimer
                                                  </button>
                                                </form>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

{% endblock pageBody %}

